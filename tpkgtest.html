<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Tour Days</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body class="p-4 bg-light">

<div id="days-container">
    <!-- Day #1 initially shown -->
    <div class="day-card border border-secondary rounded p-3 mb-3 bg-white shadow-sm">
        <div class="d-flex justify-content-between align-items-center mb-2">
            <label class="form-label fw-bold mb-0 day-label">Day #1:</label>
            <button class="btn btn-outline-danger btn-sm" onclick="deleteDay(this)">
                <i class="bi bi-trash3 me-1"></i> Delete This Day
            </button>
        </div>
        <div class="d-flex flex-wrap gap-2 mt-1 action-buttons">
            <button class="btn btn-outline-success btn-sm">
                <i class="bi bi-plus-circle me-1"></i> Create New
            </button>
            <button class="btn btn-outline-primary btn-sm">
                <i class="bi bi-pencil-square me-1"></i> Edit Template
            </button>
            <button class="btn btn-outline-secondary btn-sm">
                <i class="bi bi-archive me-1"></i> Use Existing
            </button>
        </div>
    </div>
</div>

<!-- Add Day Buttons -->
<div id="add-day-controls" class="d-flex justify-content-start gap-3 ps-1">
    <button class="btn btn-outline-dark btn-sm" onclick="addDay(false)">
        <i class="bi bi-plus-circle me-1"></i> Add Middle Day
    </button>
    <button class="btn btn-outline-dark btn-sm" onclick="addDay(true)">
        <i class="bi bi-flag me-1"></i> Add Final Day
    </button>
</div>

<script>
    function addDay(isFinal) {
        const container = document.getElementById('days-container');

        // Remove action-buttons from previous card
        const prevCard = container.lastElementChild;
        const prevActions = prevCard.querySelector('.action-buttons');
        if (prevActions) prevActions.remove();

        const newCard = document.createElement('div');
        newCard.className = 'day-card border border-secondary rounded p-3 mb-3 bg-white shadow-sm';

        let labelText = isFinal ? 'Final Day' : `Day #${container.children.length + 1}`;
        newCard.innerHTML = `
            <div class="d-flex justify-content-between align-items-center mb-2">
                <label class="form-label fw-bold mb-0 day-label">${labelText}:</label>
                <button class="btn btn-outline-danger btn-sm" onclick="deleteDay(this)">
                    <i class="bi bi-trash3 me-1"></i> Delete This Day
                </button>
            </div>
            <div class="d-flex flex-wrap gap-2 mt-1 action-buttons">
                <button class="btn btn-outline-success btn-sm">
                    <i class="bi bi-plus-circle me-1"></i> Create New
                </button>
                <button class="btn btn-outline-primary btn-sm">
                    <i class="bi bi-pencil-square me-1"></i> Edit Template
                </button>
                <button class="btn btn-outline-secondary btn-sm">
                    <i class="bi bi-archive me-1"></i> Use Existing
                </button>
            </div>
        `;

        container.appendChild(newCard);

        // Move add buttons below new card
        container.after(document.getElementById('add-day-controls'));

        // If final day added, remove the add buttons
        if (isFinal) {
            document.getElementById('add-day-controls').remove();
        }
    }

    function deleteDay(button) {
        const cardToRemove = button.closest('.day-card');
        const container = document.getElementById('days-container');

        const isFinalDay = cardToRemove.querySelector('.day-label').textContent.trim() === 'Final Day:';
        cardToRemove.remove();

        // Re-add add-day buttons if we deleted final day
        if (isFinalDay && !document.getElementById('add-day-controls')) {
            const controls = document.createElement('div');
            controls.id = 'add-day-controls';
            controls.className = 'd-flex justify-content-start gap-3 ps-1';
            controls.innerHTML = `
                <button class="btn btn-outline-dark btn-sm" onclick="addDay(false)">
                    <i class="bi bi-plus-circle me-1"></i> Add Middle Day
                </button>
                <button class="btn btn-outline-dark btn-sm" onclick="addDay(true)">
                    <i class="bi bi-flag me-1"></i> Add Final Day
                </button>
            `;
            container.after(controls);
        }

        // Renumber remaining cards
        const cards = container.querySelectorAll('.day-card');
        cards.forEach((card, index) => {
            const label = card.querySelector('.day-label');
            if (label.textContent.includes('Final Day')) return;
            label.textContent = `Day #${index + 1}:`;
        });
    }
</script>

</body>
</html>
