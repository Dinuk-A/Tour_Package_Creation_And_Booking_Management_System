<!DOCTYPE html>
<html lang="en">

<head th:replace="~{thymeleafFrs :: commonHeadFr}"></head>

<head>

    <!-- link attraction js -->
    <script src="controllerJSs/attraction.js"></script>

    <style>
        .w-33 {
            width: 32.5% !important;
        }
    </style>

</head>

<body>
    <header th:replace="~{thymeleafFrs :: headerFragment}"></header>
    <aside th:replace="~{thymeleafFrs :: asideFragment}"></aside>
    <div th:replace="~{thymeleafFrs :: userInfoEditModalFragment}"></div>
    <div th:replace="~{thymeleafFrs :: customAlertFragment}"></div>

    <main id="mainAreaID" class="main min-vh-100 mx-auto">

        <!-- Tabs navigation panel -->
        <ul class="nav nav-tabs pe-0" id="myTab" role="tablist">
            <!-- for table side -->
            <li class="nav-item" role="presentation">
                <a class="nav-link active" id="table-tab" data-bs-toggle="tab" href="#tableTabPane" role="tab"
                    aria-controls="tableTabPane" aria-selected="true">Table</a>
            </li>
            <!-- for form side -->
            <li class="nav-item" role="presentation">
                <a class="nav-link" id="form-tab" data-bs-toggle="tab" href="#formAttractionHolderDiv" role="tab"
                    aria-controls="formAttractionHolderDiv" aria-selected="false" onclick="setAttrStatusAuto()">
                    Form</a>
            </li>
        </ul>

        <!-- Tabs content -->
        <div class="tab-content mt-1" id="myTabContent">

            <!-- Table tab  -->
            <div id="tableTabPane" class="tab-pane fade show active table-container p-4 bg-light rounded-3"
                role="tabpanel" aria-labelledby="table-tab">

                <!-- filters row -->
                <div class="row mb-2">
                    <!-- by district -->
                    <div class="col-md-4">
                        <label for="attrDistrictFilter" class="form-label fw-bold mb-0">Filter by District</label>
                        <select id="attrDistrictFilter" class="form-select" onchange="applyAttrFilters();">
                            <!--will be dynamically filled by database -->
                        </select>
                    </div>

                    <!-- by status -->
                    <div class="col-md-4">
                        <label for="attrStatusFilter" class="form-label fw-bold mb-0">Filter by Status</label>
                        <select id="attrStatusFilter" class="form-select" onchange="applyAttrFilters();">
                            <option value="" selected disabled> Select Status </option>
                            <option value="all"> All </option>
                            <option value="open"> Open for Tours </option>
                            <option value="permanantly_closed"> Permanantly Closed </option>
                            <option value="temporary_closed"> Temporary Closed </option>
                            <option value="ifDeleted" > Deleted Record </option>
                        </select>
                    </div>

                    <!-- reset btm -->
                    <div class="col-md-4 text-end">
                        <button onclick="resetAttrFilters()" class="btn btn-outline-warning mt-3">Reset
                            Filters</button>
                    </div>

                </div>

                <div id="tableAttractionHolderDiv">
                    <!-- a table will be dynamically generated in here -->
                </div>

            </div>

            <!-- Form tab -->
            <div class="tab-pane fade" id="formAttractionHolderDiv" role="tabpanel" aria-labelledby="form-tab">

                <div class="card mx-auto" style="width: 1100px;">

                    <div class="card-header bg-primary text-white text-center">
                        <h3 class="mb-0">Attraction Management Form</h3>
                    </div>

                    <div class="card-body" style="background-color: ivory;">

                        <form id="formAttraction" onsubmit="return false">

                            <!-- NAME AND STATUS ROW -->
                            <div class="mb-2">
                                <div class="input-group">
                                    <!-- Name Label -->
                                    <label class="form-label" for="inputPlaceName" style="width:65%">Name :</label>

                                    <!-- Status label -->
                                    <label for="selectAttrStatus" class="form-label">Status: </label>

                                </div>

                                <div class="input-group">
                                    <!-- Name Input -->
                                    <input id="inputPlaceName"
                                        onkeyup="inputValidatorText(this, '^(?!\s*$)\S[\s\S]{0,99}$' ,'attraction' ,'name' )" type="text"
                                        class="form-control form-input me-2" style="width:35%"
                                        placeholder="Enter The Attraction's Name">

                                    <!-- Status input -->
                                    <select required id="selectAttrStatus" class="form-select"
                                        onchange="staticSelectValidator(this,'attraction','attr_status')">
                                        <option value="" selected disabled> Select Status </option>
                                        <option value="open"> Open for Tours </option>
                                        <option value="permanantly_closed"> Permanantly Closed </option>
                                        <option value="temporary_closed"> Temporary Closed </option>
                                        <option value="ifDeleted" class="d-none"> Deleted Record </option>
                                    </select>
                                </div>
                            </div>

                            <!-- Province and District starts -->
                            <div class="mb-2">
                                <div class="input-group">
                                    <!-- Label for PROVINCE -->
                                    <label class="form-label w-50" for="selectAttrProvince">Province
                                    </label>

                                    <!-- Label for DISTRICT -->
                                    <label for="selectAttrDistrict" class="form-label w-50">District
                                    </label>

                                </div>

                                <div class="input-group">

                                    <!-- SELECT PROVINCE -->
                                    <select id="selectAttrProvince" class="form-control form-select"
                                        onchange="getDistByProvince()">
                                    </select>

                                    <!-- SELECT DISTRICT -->
                                    <select id="selectAttrDistrict" class="ms-3 form-control form-select"
                                        onchange="dynamicSelectValidator(this,'attraction','district_id')">

                                    </select>
                                </div>
                            </div>

                            <!--TYPES accordion starts -->
                            <div class="mb-2 w-100 border p-3 accordion accordion-flush mt-2" id="accordionForTypes">

                                <div class="accordion-item ">

                                    <!-- <h5 class="accordion-header mb-2"> -->
                                    <div class="accordion-header mb-2">

                                        <button class="p-0 accordion-button collapsed fw-bold " type="button"
                                            data-bs-toggle="collapse" data-bs-target="#flushCollapseOne"
                                            aria-expanded="false" aria-controls="flushCollapseOne">

                                            <h5 class="text-info"> Categories : Click to Expand</h5>
                                        </button>
                                    </div>

                                    <div id="flushCollapseOne" class="accordion-collapse collapse ps-4"
                                        data-bs-parent="#accordionForTypes">
                                        <div class="accordion-body bg-light d-flex justify-content-between">

                                            <!-- this will be filled by a JS -->

                                        </div>
                                    </div>
                                </div>

                            </div>

                            <!-- Activities accordion starts-->
                            <!-- <div class="mb-2 w-100 border p-3 accordion accordion-flush mt-2"
                                id="acc#accordionForActivities">
                                <div class="accordion-item ">
                                    <h5 class="accordion-header mb-2">
                                        <button class="p-0 accordion-button collapsed fw-bold " type="button"
                                            data-bs-toggle="collapse" data-bs-target="#flushCollapseTwo"
                                            aria-expanded="false" aria-controls="flushCollapseTwo">
                                            <h5 class="text-info"> Nearby Activities : Click to view</h5>
                                        </button>
                                    </h5>
                                    <div id="flushCollapseTwo" class="accordion-collapse collapse ps-4"
                                        data-bs-parent="#accordionForActivities">
                                        <div class="accordion-body bg-light d-flex justify-content-between">

                                           
                                        </div>
                                    </div>
                                </div>

                            </div> -->

                            <!-- Entrance Fees Section -->
                            <div class="mb-2">
                                <div class="row">
                                    <h5>Entrance Fees</h5>

                                    <!-- 3 Check Boxes for Entrance Fees -->
                                    <div class="input-group">

                                        <!-- CB 1 -->
                                        <input type="radio" class="btn-check" id="allEntryFreeChkBox" autocomplete="off"
                                            name="entranceFees" value="All Free"
                                            onchange="allEntryFree(); attraction.feetype = this.value ">

                                        <label class="btn btn-outline-success w-33 rounded-start"
                                            for="allEntryFreeChkBox">All
                                            Free</label>

                                        <!--CB 2  -->
                                        <input type="radio" class="btn-check" id="localsEntryFreeCheckBox"
                                            autocomplete="off" value="Local Free" name="entranceFees"
                                            onchange="localsEntryFree(); attraction.feetype = this.value">

                                        <label class="ms-1 btn btn-outline-warning w-33"
                                            for="localsEntryFreeCheckBox">Local
                                            Free</label>

                                        <!-- CB 3 -->
                                        <input type="radio" class="btn-check" id="allPaidCheckBox" autocomplete="off"
                                            name="entranceFees" value="All Paid"
                                            onchange="allPaid(); attraction.feetype = this.value">
                                        <!-- checked -->

                                        <label class="btn ms-1 btn-outline-danger w-33" for="allPaidCheckBox">All
                                            Paid</label>
                                    </div>
                                </div>

                            </div>

                            <div class="mb-2">
                                <!--INPUT ENTRANCE FEES -->
                                <div class="row">

                                    <div class="col-6 bg-light border">

                                        <h5 class="mt-1">Local Fees</h5>

                                        <!-- Local ADULT -->
                                        <div class="row mt-1 mb-3">
                                            <div class="col-6">

                                                <label class="form-label mb-0" for="inputLocalAdultFee">Local
                                                    Adult</label>

                                                <div class="input-group">
                                                    <span class="input-group-text p-1 pb-0">
                                                        <h6 class="my-auto">LKR</h6>
                                                    </span>
                                                    <input type="number" id="inputLocalAdultFee"
                                                        class="form-control form-input w-85 p-1 text-center"
                                                        placeholder=""
                                                        onkeyup="inputValidatorNumber(this,'','attraction','feelocaladult')"
                                                        onblur="insertDecimals(this);">
                                                        <!-- ^(?!0+$)\\d+(\\.\\d{1,2})? -->
                                                </div>


                                            </div>

                                            <!-- Local CHILD -->
                                            <div class="col-6">

                                                <label class="form-label mb-0" for="inputLocalChildFee">Local
                                                    Children</label>

                                                <div class="input-group">
                                                    <span class="input-group-text p-1 pb-0">
                                                        <h6 class="my-auto">LKR</h6>
                                                    </span>
                                                    <input type="number" id="inputLocalChildFee"
                                                        class="form-control form-input w-85 p-1 text-center"
                                                        placeholder=""
                                                        onkeyup="inputValidatorText(this,'','attraction','feechildlocal')"
                                                        onblur="insertDecimals(this);">
                                                </div>


                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-6 bg-light border">

                                        <h5 class="mt-1">Foreign Fees</h5>

                                        <!-- Foreign ADULT -->
                                        <div class="row mt-1 mb-3 ">
                                            <div class="col-6">
                                                <label class="form-label mb-0" for="inputForeignAdultFee">Foreign
                                                    Adult</label>

                                                <div class="input-group">
                                                    <span class="input-group-text p-1 pb-0">
                                                        <h6 class="my-auto">LKR</h6>
                                                    </span>
                                                    <input type="number" id="inputForeignAdultFee"
                                                        class="form-control form-input w-85 p-1 text-center"
                                                        placeholder=""
                                                        onkeyup="inputValidatorText(this,'','attraction','feeforeignadult')"
                                                        onblur="insertDecimals(this);">
                                                </div>
                                            </div>

                                            <div class="col-6">

                                                <label class="form-label mb-0" for="inputForeignChildFee">Foreign
                                                    Children</label>

                                                <div class="input-group">
                                                    <span class="input-group-text p-1 pb-0">
                                                        <h6 class="my-auto">LKR</h6>
                                                    </span>
                                                    <input type="number" id="inputForeignChildFee"
                                                        class="form-control form-input w-85 p-1 text-center"
                                                        placeholder=""
                                                        onkeyup="inputValidatorText(this,'','attraction','feechildforeign')"
                                                        onblur="insertDecimals(this);">
                                                </div>

                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>

                            <!-- location description, replace this somewehere else -->
                            <div class="row mt-2">
                                <div class="col-8">
                                    <label for="inputShortDescription" class="form-label fw-bold">Location Description
                                        :</label>
                                    <textarea class="form-control" id="inputShortDescription"
                                        onkeyup="inputValidatorText(this,'^(?!\s*$)[\s\S]{1,200}$','attraction','description')"
                                        style="height: 100px;"
                                        placeholder="Enter A Short Description About The Location"></textarea>
                                </div>

                                <div class="col-4">
                                    <label for="inputGeoCoords" class="form-label fw-bold">Geo Coords :</label>
                                    <input type="text" id="inputGeoCoords" class="form-control form-input"
                                        placeholder="Paste Here From Google Maps"
                                        oninput="inputValidatorText(this,'','attraction','gcoords')">
                                </div>
                            </div>

                            <!-- NOTE -->
                            <div class="row mt-2 border bg-light">

                                <div class="col-7 pb-2">
                                    <label for="inputNote" class="form-label fw-bold">Additional Information :</label>
                                    <textarea class="form-control" placeholder="Enter Any Additional Information "
                                        id="inputNote" onkeyup="inputValidatorText(this,'^(?!\s*$)[\s\S]{1,200}$','attraction','note')"
                                        style="height: 100px;"></textarea>
                                </div>

                                <div class="col-5 ms-0 me-0">

                                    <div class="row w-100 mb-2">
                                        <div class="col-8">
                                            <!-- PARKING FEE STARTS -->
                                            <label for="vehiParkingFeeInput" class="form-label mb-0">Parking
                                                Fee(Per Hour)
                                                :
                                            </label>

                                            <div class="input-group mb-1">
                                                <span class="input-group-text p-1 pb-0">
                                                    <h6 class="my-auto">LKR</h6>
                                                </span>
                                                <input type="number" id="vehiParkingFeeInput"
                                                    class="form-control form-input p-1 text-center "
                                                    placeholder="150.00"
                                                    onkeyup="inputValidatorText(this,'','attraction','vehicleparkingfee')"
                                                    onblur="insertDecimals(this);">
                                                    <!-- ^(?!0+(?:\.0{1,2})?$)(\d{1,3})(\.\d{1,2})?$ -->

                                            </div>
                                        </div>

                                        <div class="col-4 my-auto">
                                            <input type="checkbox" class="btn-check" id="freeParkingCBX"
                                                onchange="freeParkingCheckBox(); ">

                                            <label class="btn btn-outline-success rounded-start"
                                                for="freeParkingCBX">Free</label>
                                        </div>

                                    </div>

                                    <div class="row w-100 mt-2">
                                        <!-- DURATION -->
                                        <label for="inputTourDuration" class="form-label mb-0"> Tour Duration </label>

                                        <div class="input-group mt-1">
                                            <input type="number" class="form-control form-input p-1 text-center"
                                                id="inputTourDuration" placeholder="1.5"
                                                onkeyup="inputValidatorText(this,'','attraction','duration')">
                                            <span class="input-group-text p-1 pb-0 w-50 text-center">
                                                <h6 class="my-auto">Hours</h6>
                                                <!-- ^(0(\.25|\.50|\.75)?|([1-9]|1[0-2])(\.00|\.25|\.50|\.75)?|12(\.00)?)$ -->
                                            </span>
                                        </div>
                                    </div>


                                </div>
                            </div>

                            <!--3 form buttons starts -->
                            <div class="row mt-3">

                                <div class="col-3">
                                    <button type="reset" class="btn-clear fw-bold" onclick="refreshAttractionForm()">
                                        Reset Form</button>
                                </div>

                                <div class="col-9 text-end">
                                    <button type="button" id="attraUpdateBtn" class="btn-update fw-bold"
                                        onclick="updateAttraction()" style="pointer-events: all;">Update Entry</button>

                                    <button type="submit" id="attraAddBtn" class="btn-add fw-bold"
                                        onclick="addNewAttraction()" style="pointer-events: all;">Add Entry</button>
                                </div>
                            </div>

                        </form>

                    </div>
                </div>

            </div>

        </div>

        <!-- Modal to display full details of a row -->
        <div class="modal fade py-5" id="infoModalAttraction" tabindex="-1" aria-labelledby="infoModalLabel"
            aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content shadow-lg rounded-4">
                    <!-- Modal Header -->
                    <div class="modal-header bg-primary text-white">
                        <h5 class="modal-title" id="infoModalLabel">Attraction Full Details</h5>
                        <button type="button" class="btn-close text-white" data-bs-dismiss="modal"
                            aria-label="Close"></button>
                    </div>

                    <!-- Modal Body -->
                    <div class="modal-body bg-light">
                        <div class="container">

                            <!-- Row 1: Name and Status -->
                            <div class="row mb-4 align-items-start">
                                <div class="col-md-8">
                                    <p class="fw-bold mb-1 text-primary">Name:</p>
                                    <p id="modalAttrName" class="mb-2"></p>
                                </div>
                                <div class="col-md-4">
                                    <p class="fw-bold mb-1 text-primary">Status:</p>
                                    <p id="modalAttrStatus" class="mb-2"></p>
                                </div>
                            </div>

                            <!-- Row 2: District, Province, Geo Coords -->
                            <div class="row mb-4">
                                <div class="col-md-4">
                                    <p class="fw-bold mb-1 text-primary">District:</p>
                                    <p id="modalAttrDistrict" class="mb-2"></p>
                                </div>
                                <div class="col-md-4">
                                    <p class="fw-bold mb-1 text-primary">Province:</p>
                                    <p id="modalAttrProvince" class="mb-2"></p>
                                </div>
                                <div class="col-md-4">
                                    <p class="fw-bold mb-1 text-primary">Geo Coords:</p>
                                    <p id="modalAttrGCoords" class="mb-2"></p>
                                </div>
                            </div>

                            <!-- Row 3: Categories and Description -->
                            <div class="row mb-4">
                                <div class="col-md-6">
                                    <p class="fw-bold mb-1 text-primary">Categories:</p>
                                    <p id="modalAttrCategories" class="mb-2"></p>
                                </div>
                                <div class="col-md-6">
                                    <p class="fw-bold mb-1 text-primary">Description:</p>
                                    <p id="modalAttrDescription" class="mb-2"></p>
                                </div>
                            </div>

                            <!-- Row 4: Entrance Fees -->
                            <div class="row mb-4">
                                <div class="col-md-3">
                                    <p class="fw-bold mb-1 text-primary">Local Adult Fee:</p>
                                    <p id="modalAttrLocalAdultFee" class="mb-2"></p>
                                </div>
                                <div class="col-md-3">
                                    <p class="fw-bold mb-1 text-primary">Local Child Fee:</p>
                                    <p id="modalAttrLocalChildFee" class="mb-2"></p>
                                </div>
                                <div class="col-md-3">
                                    <p class="fw-bold mb-1 text-primary">Foreign Adult Fee:</p>
                                    <p id="modalAttrForeignAdultFee" class="mb-2"></p>
                                </div>
                                <div class="col-md-3">
                                    <p class="fw-bold mb-1 text-primary">Foreign Child Fee:</p>
                                    <p id="modalAttrForeignChildFee" class="mb-2"></p>
                                </div>
                            </div>

                            <!-- Row 5: Duration and Parking Fee -->
                            <div class="row mb-4">
                                <div class="col-md-6">
                                    <p class="fw-bold mb-1 text-primary">Staying Duration:</p>
                                    <p id="modalAttrDuration" class="mb-2"></p>
                                </div>
                                <div class="col-md-6">
                                    <p class="fw-bold mb-1 text-primary">Vehicle Parking Fee(Per Hour):</p>
                                    <p id="modalAttrVehicleParkingFee" class="mb-2"></p>
                                </div>
                            </div>

                            <!-- Final Row: Additional Info -->
                            <div class="row mb-3">
                                <div class="col-md-8">
                                    <p class="fw-bold mb-1 text-primary">Additional Details:</p>
                                    <p id="modalAttrNote" class="mb-2"></p>
                                </div>
                                <div class="col-md-4">
                                    <p id="modalAttrIfDeleted" class="text-danger d-none mb-0"></p>
                                </div>
                            </div>

                        </div>
                    </div>

                    <!-- Modal Footer -->
                    <div class="modal-footer d-flex justify-content-between bg-light">

                        <button class="btn-print fw-bold d-none" onclick="printAttractionRecord()">
                            Print Record
                        </button>
                        <div>
                            <button id="modalAttrEditBtn" class="btn-edit me-2 fw-bold"
                                onclick="refillAttractionForm(window['currentObject'])">
                                Edit Entry
                            </button>
                            <button id="modalAttrDeleteBtn" class="btn-delete fw-bold"
                                onclick="deleteAttractionRecord(window['currentObject'])">
                                Delete Entry
                            </button>
                            <button id="modalAttrRecoverBtn" class="btn-restore d-none fw-bold"
                                onclick="restoreAttractionRecord()">
                                Restore Entry
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </main>

</body>

</html>